

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The Architecture &mdash; symfony-docs-fr v0.1 documentation</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="symfony-docs-fr v0.1 documentation" href="../index.html" />
    <link rel="up" title="Visite éclair" href="index.html" />
    <link rel="next" title="Manuel" href="../book/index.html" />
    <link rel="prev" title="The Controller" href="the_controller.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../book/index.html" title="Manuel"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="the_controller.html" title="The Controller"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">symfony-docs-fr v0.1 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Visite éclair</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="the-architecture">
<h1>The Architecture<a class="headerlink" href="#the-architecture" title="Permalink to this headline">¶</a></h1>
<p>You are my hero! Who would have thought that you would still be here after the
first three parts? Your efforts will be well-rewarded soon. The first three
parts didn&#8217;t look too deeply at the architecture of the framework. As it makes
Symfony2 stand apart from the framework crowd, let&#8217;s dive into it now.</p>
<div class="section" id="the-directory-structure">
<span id="index-0"></span><h2>The Directory Structure<a class="headerlink" href="#the-directory-structure" title="Permalink to this headline">¶</a></h2>
<p>The directory structure of a Symfony2 <a class="reference internal" href="../glossary.html#term-application"><em class="xref std std-term">application</em></a> is rather flexible
but the directory structure of the sandbox reflects the typical and recommended
structure of a Symfony2 application:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">app/</span></tt>: The application configuration;</li>
<li><tt class="docutils literal"><span class="pre">src/</span></tt>: The project&#8217;s PHP code;</li>
<li><tt class="docutils literal"><span class="pre">vendor/</span></tt>: The third-party dependencies;</li>
<li><tt class="docutils literal"><span class="pre">web/</span></tt>: The web root directory.</li>
</ul>
<div class="section" id="the-web-directory">
<h3>The Web Directory<a class="headerlink" href="#the-web-directory" title="Permalink to this headline">¶</a></h3>
<p>The web root directory is the home of all public and static files like images,
stylesheets, and JavaScript files. It is also where each <em class="xref std std-term">front controller</em>
lives:</p>
<div class="highlight-python"><pre>// web/app.php
require_once __DIR__.'/../app/bootstrap.php';
require_once __DIR__.'/../app/AppKernel.php';

use Symfony\Component\HttpFoundation\Request;

$kernel = new AppKernel('prod', false);
$kernel-&gt;handle(Request::createFromGlobals())-&gt;send();</pre>
</div>
<p>The kernel requires first requires the <tt class="docutils literal"><span class="pre">bootstrap.php</span></tt> file, which
bootstraps the framework and registers the autoloader (see below).</p>
<p>Like any front controller, <tt class="docutils literal"><span class="pre">app.php</span></tt> uses a Kernel Class, <tt class="docutils literal"><span class="pre">AppKernel</span></tt>, to
bootstrap the application.</p>
</div>
<div class="section" id="the-application-directory">
<span id="index-1"></span><h3>The Application Directory<a class="headerlink" href="#the-application-directory" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">AppKernel</span></tt> class is the main entry point of the application
configuration and as such, it is stored in the <tt class="docutils literal"><span class="pre">app/</span></tt> directory.</p>
<p>This class must implement four methods:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">registerRootDir()</span></tt>: Returns the configuration root directory;</li>
<li><tt class="docutils literal"><span class="pre">registerBundles()</span></tt>: Returns an array of all bundles needed to run the
application (notice the reference to <tt class="docutils literal"><span class="pre">Sensio\HelloBundle\HelloBundle</span></tt>);</li>
<li><tt class="docutils literal"><span class="pre">registerContainerConfiguration()</span></tt>: Loads the configuration (more on this
later);</li>
</ul>
<p>Have a look at the default implementation of these methods to better
understand the flexibility of the framework.</p>
<p>PHP autoloading can be configured via <tt class="docutils literal"><span class="pre">autoload.php</span></tt>:</p>
<div class="highlight-python"><pre>// app/autoload.php
use Symfony\Component\ClassLoader\UniversalClassLoader;

$loader = new UniversalClassLoader();
$loader-&gt;registerNamespaces(array(
    'Symfony'                        =&gt; __DIR__.'/../vendor/symfony/src',
    'Sensio'                         =&gt; __DIR__.'/../src',
    'Doctrine\\Common\\DataFixtures' =&gt; __DIR__.'/../vendor/doctrine-data-fixtures/lib',
    'Doctrine\\Common'               =&gt; __DIR__.'/../vendor/doctrine-common/lib',
    'Doctrine\\DBAL\\Migrations'     =&gt; __DIR__.'/../vendor/doctrine-migrations/lib',
    'Doctrine\\MongoDB'              =&gt; __DIR__.'/../vendor/doctrine-mongodb/lib',
    'Doctrine\\ODM\\MongoDB'         =&gt; __DIR__.'/../vendor/doctrine-mongodb-odm/lib',
    'Doctrine\\DBAL'                 =&gt; __DIR__.'/../vendor/doctrine-dbal/lib',
    'Doctrine'                       =&gt; __DIR__.'/../vendor/doctrine/lib',
    'Zend'                           =&gt; __DIR__.'/../vendor/zend/library',
));
$loader-&gt;registerPrefixes(array(
    'Twig_Extensions_' =&gt; __DIR__.'/../vendor/twig-extensions/lib',
    'Twig_'            =&gt; __DIR__.'/../vendor/twig/lib',
    'Swift_'           =&gt; __DIR__.'/../vendor/swiftmailer/lib/classes',
));
$loader-&gt;register();</pre>
</div>
<p>The <tt class="docutils literal"><span class="pre">UniversalClassLoader</span></tt> from Symfony2 is used to autoload files that
respect either the technical interoperability <a class="reference external" href="http://groups.google.com/group/php-standards/web/psr-0-final-proposal">standards</a> for PHP 5.3
namespaces or the PEAR naming <a class="reference external" href="http://pear.php.net/">convention</a> for classes. As you can see
here, all dependencies are stored under the <tt class="docutils literal"><span class="pre">vendor/</span></tt> directory, but this is
just a convention. You can store them wherever you want, globally on your
server or locally in your projects.</p>
</div>
</div>
<div class="section" id="the-bundle-system">
<span id="index-2"></span><h2>The Bundle System<a class="headerlink" href="#the-bundle-system" title="Permalink to this headline">¶</a></h2>
<p>This section introduces one of the greatest and most powerful features of
Symfony2, the <a class="reference internal" href="../glossary.html#term-bundle"><em class="xref std std-term">bundle</em></a> system.</p>
<p>A bundle is kind of like a plugin in other software. So why is it called
<em>bundle</em> and not <em>plugin</em>? Because <em>everything</em> is a bundle in Symfony2, from
the core framework features to the code you write for your application.
Bundles are first-class citizens in Symfony2. This gives you the flexibility
to use pre-built features packaged in third-party bundles or to distribute
your own bundles. It makes it easy to pick and choose which features to enable
in your application and optimize them the way you want.</p>
<p>An application is made up of bundles as defined in the <tt class="docutils literal"><span class="pre">registerBundles()</span></tt>
method of the <tt class="docutils literal"><span class="pre">AppKernel</span></tt> class:</p>
<div class="highlight-python"><pre>// app/AppKernel.php
public function registerBundles()
{
    $bundles = array(
        new Symfony\Bundle\FrameworkBundle\FrameworkBundle(),
        new Symfony\Bundle\TwigBundle\TwigBundle(),

        // enable third-party bundles
        new Symfony\Bundle\ZendBundle\ZendBundle(),
        new Symfony\Bundle\SwiftmailerBundle\SwiftmailerBundle(),
        new Symfony\Bundle\DoctrineBundle\DoctrineBundle(),
        //new Symfony\Bundle\DoctrineMigrationsBundle\DoctrineMigrationsBundle(),
        //new Symfony\Bundle\DoctrineMongoDBBundle\DoctrineMongoDBBundle(),

        // register your bundles
        new Sensio\HelloBundle\HelloBundle(),
    );

    if ($this-&gt;isDebug()) {
        $bundles[] = new Symfony\Bundle\WebProfilerBundle\WebProfilerBundle();
    }

    return $bundles;
}</pre>
</div>
<p>In addition to the <tt class="docutils literal"><span class="pre">HelloBundle</span></tt> that we have already talked about, notice
that the kernel also enables <tt class="docutils literal"><span class="pre">FrameworkBundle</span></tt>, <tt class="docutils literal"><span class="pre">DoctrineBundle</span></tt>,
<tt class="docutils literal"><span class="pre">SwiftmailerBundle</span></tt>, and <tt class="docutils literal"><span class="pre">ZendBundle</span></tt>. They are all part of the core
framework.</p>
<p>Each bundle can be customized via configuration files written in YAML, XML, or
PHP. Have a look at the default configuration:</p>
<p>Each entry like <tt class="docutils literal"><span class="pre">framework</span></tt> defines the configuration for a bundle.</p>
<p>Each <em class="xref std std-term">environment</em> can override the default configuration by providing a
specific configuration file:</p>
<p>Do you understand now why Symfony2 is so flexible? Share your bundles between
applications, store them locally or globally, your choice.</p>
</div>
<div class="section" id="using-vendors">
<span id="index-3"></span><h2>Using Vendors<a class="headerlink" href="#using-vendors" title="Permalink to this headline">¶</a></h2>
<p>Odds are that your application will depend on third-party libraries. Those
should be stored in the <tt class="docutils literal"><span class="pre">src/vendor/</span></tt> directory. This directory already
contains the Symfony2 libraries, the SwiftMailer library, the Doctrine ORM,
the Twig templating system, and a selection of the Zend Framework classes.</p>
</div>
<div class="section" id="cache-and-logs">
<span id="index-4"></span><h2>Cache and Logs<a class="headerlink" href="#cache-and-logs" title="Permalink to this headline">¶</a></h2>
<p>Symfony2 is probably one of the fastest full-stack frameworks around. But how
can it be so fast if it parses and interprets tens of YAML and XML files for
each request? This is partly due to its cache system. The application
configuration is only parsed for the very first request and then compiled down
to plain PHP code stored in the <tt class="docutils literal"><span class="pre">cache/</span></tt> application directory. In the
development environment, Symfony2 is smart enough to flush the cache when you
change a file. But in the production environment, it is your responsibility
to clear the cache when you update your code or change its configuration.</p>
<p>When developing a web application, things can go wrong in many ways. The log
files in the <tt class="docutils literal"><span class="pre">logs/</span></tt> application directory tell you everything about the
requests and help you fix the problem quickly.</p>
</div>
<div class="section" id="the-command-line-interface">
<span id="index-5"></span><h2>The Command Line Interface<a class="headerlink" href="#the-command-line-interface" title="Permalink to this headline">¶</a></h2>
<p>Each application comes with a command line interface tool (<tt class="docutils literal"><span class="pre">console</span></tt>) that
helps you maintain your application. It provides commands that boost your
productivity by automating tedious and repetitive tasks.</p>
<p>Run it without any arguments to learn more about its capabilities:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>php app/console
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">--help</span></tt> option helps you discover the usage of a command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>php app/console router:debug --help
</pre></div>
</div>
</div>
<div class="section" id="final-thoughts">
<h2>Final Thoughts<a class="headerlink" href="#final-thoughts" title="Permalink to this headline">¶</a></h2>
<p>Call me crazy, but after reading this part, you should be comfortable with
moving things around and making Symfony2 work for you. Everything is done in
Symfony2 to get out of your way. So, feel free to rename and move directories
around as you see fit.</p>
<p>And that&#8217;s all for the quick tour. From testing to sending emails, you still
need to learn a lot to become a Symfony2 master. Ready to dig into these
topics now? Look no further - go to the official <a class="reference external" href="http://www.symfony-reloaded.org/learn">book</a> and pick any topic
you want.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">The Architecture</a><ul>
<li><a class="reference internal" href="#the-directory-structure">The Directory Structure</a><ul>
<li><a class="reference internal" href="#the-web-directory">The Web Directory</a></li>
<li><a class="reference internal" href="#the-application-directory">The Application Directory</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-bundle-system">The Bundle System</a></li>
<li><a class="reference internal" href="#using-vendors">Using Vendors</a></li>
<li><a class="reference internal" href="#cache-and-logs">Cache and Logs</a></li>
<li><a class="reference internal" href="#the-command-line-interface">The Command Line Interface</a></li>
<li><a class="reference internal" href="#final-thoughts">Final Thoughts</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="the_controller.html"
                        title="previous chapter">The Controller</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../book/index.html"
                        title="next chapter">Manuel</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/quick_tour/the_architecture.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../book/index.html" title="Manuel"
             >next</a> |</li>
        <li class="right" >
          <a href="the_controller.html" title="The Controller"
             >previous</a> |</li>
        <li><a href="../index.html">symfony-docs-fr v0.1 documentation</a> &raquo;</li>
          <li><a href="index.html" >Visite éclair</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>